import allCrypto from './static/cryptoTable.json' with { type: 'json' };
// import { fetchAllStockData } from './scripts/stock_data.js'

// allStock = fetchAllStockData()
// const allData = [{
//     "symbol": "DCR",
//     "data": [
//         {
//             "date": "2024-06-01T23:59:00.0000000Z",
//             "close": 20.0627462987388
//         },
//         {
//             "date": "2024-06-02T23:59:00.0000000Z",
//             "close": 19.5333906094995
//         },
//         {
//             "date": "2024-06-03T23:59:00.0000000Z",
//             "close": 19.416329365243
//         },
//         {
//             "date": "2024-06-04T23:59:00.0000000Z",
//             "close": 20.2911462968146
//         },
//         {
//             "date": "2024-06-05T23:59:00.0000000Z",
//             "close": 21.0993762943592
//         },
//         {
//             "date": "2024-06-06T23:59:00.0000000Z",
//             "close": 21.805748868781
//         },
//         {
//             "date": "2024-06-07T23:59:00.0000000Z",
//             "close": 19.6129905176126
//         },
//         {
//             "date": "2024-06-08T23:59:00.0000000Z",
//             "close": 18.9645620440831
//         },
//         {
//             "date": "2024-06-09T23:59:00.0000000Z",
//             "close": 19.3944382250757
//         },
//         {
//             "date": "2024-06-10T23:59:00.0000000Z",
//             "close": 18.5411666679537
//         },
//         {
//             "date": "2024-06-11T23:59:00.0000000Z",
//             "close": 17.8782568398007
//         },
//         {
//             "date": "2024-06-12T23:59:00.0000000Z",
//             "close": 18.4723165089624
//         },
//         {
//             "date": "2024-06-13T23:59:00.0000000Z",
//             "close": 18.0615510156189
//         },
//         {
//             "date": "2024-06-14T23:59:00.0000000Z",
//             "close": 17.6771794448453
//         },
//         {
//             "date": "2024-06-15T23:59:00.0000000Z",
//             "close": 17.9889365229272
//         },
//         {
//             "date": "2024-06-16T23:59:00.0000000Z",
//             "close": 17.9078059895423
//         },
//         {
//             "date": "2024-06-17T23:59:00.0000000Z",
//             "close": 15.575224747216
//         },
//         {
//             "date": "2024-06-18T23:59:00.0000000Z",
//             "close": 14.9509921120403
//         },
//         {
//             "date": "2024-06-19T23:59:00.0000000Z",
//             "close": 14.9243257633648
//         },
//         {
//             "date": "2024-06-20T23:59:00.0000000Z",
//             "close": 15.4606922542505
//         },
//         {
//             "date": "2024-06-21T23:59:00.0000000Z",
//             "close": 15.3717260759502
//         },
//         {
//             "date": "2024-06-22T23:59:00.0000000Z",
//             "close": 15.214159656309
//         },
//         {
//             "date": "2024-06-23T23:59:00.0000000Z",
//             "close": 14.8030840990035
//         },
//         {
//             "date": "2024-06-24T23:59:00.0000000Z",
//             "close": 15.1599525259546
//         },
//         {
//             "date": "2024-06-25T23:59:00.0000000Z",
//             "close": 15.5966905320337
//         },
//         {
//             "date": "2024-06-26T23:59:00.0000000Z",
//             "close": 15.1618688358556
//         },
//         {
//             "date": "2024-06-27T23:59:00.0000000Z",
//             "close": 15.6178843689215
//         },
//         {
//             "date": "2024-06-28T23:59:00.0000000Z",
//             "close": 15.4111199003088
//         },
//         {
//             "date": "2024-06-29T23:59:00.0000000Z",
//             "close": 14.9642996004496
//         },
//         {
//             "date": "2024-06-30T23:59:00.0000000Z",
//             "close": 15.2410113826838
//         },
//         {
//             "date": "2024-07-01T23:59:00.0000000Z",
//             "close": 14.7258272574398
//         },
//         {
//             "date": "2024-07-02T23:59:00.0000000Z",
//             "close": 14.0803073797489
//         },
//         {
//             "date": "2024-07-03T23:59:00.0000000Z",
//             "close": 13.4487973012618
//         },
//         {
//             "date": "2024-07-04T23:59:00.0000000Z",
//             "close": 12.52233602724
//         },
//         {
//             "date": "2024-07-05T23:59:00.0000000Z",
//             "close": 12.77036536858
//         },
//         {
//             "date": "2024-07-06T23:59:00.0000000Z",
//             "close": 13.5712563258171
//         },
//         {
//             "date": "2024-07-07T23:59:00.0000000Z",
//             "close": 12.5079956757775
//         },
//         {
//             "date": "2024-07-08T23:59:00.0000000Z",
//             "close": 13.1038021031693
//         },
//         {
//             "date": "2024-07-09T23:59:00.0000000Z",
//             "close": 13.3281499682246
//         },
//         {
//             "date": "2024-07-10T23:59:00.0000000Z",
//             "close": 13.3992302158999
//         },
//         {
//             "date": "2024-07-11T23:59:59.9000000Z",
//             "close": 13.1407518899852
//         },
//         {
//             "date": "2024-07-12T23:59:59.9000000Z",
//             "close": 13.4428254243794
//         },
//         {
//             "date": "2024-07-13T23:59:59.9000000Z",
//             "close": 13.5599658058946
//         },
//         {
//             "date": "2024-07-14T23:59:00.0000000Z",
//             "close": 13.5347304839927
//         },
//         {
//             "date": "2024-07-15T23:59:59.9000000Z",
//             "close": 14.0159203046113
//         },
//         {
//             "date": "2024-07-16T23:59:59.9000000Z",
//             "close": 13.9088201524184
//         },
//         {
//             "date": "2024-07-17T23:59:59.9000000Z",
//             "close": 13.9345606140069
//         },
//         {
//             "date": "2024-07-18T23:59:59.9000000Z",
//             "close": 13.0117117539728
//         },
//         {
//             "date": "2024-07-19T23:59:59.9000000Z",
//             "close": 13.3829653866256
//         },
//         {
//             "date": "2024-07-20T23:59:00.0000000Z",
//             "close": 13.0016519906237
//         },
//         {
//             "date": "2024-07-21T23:59:47.4000000Z",
//             "close": 13.0996849626539
//         },
//         {
//             "date": "2024-07-22T23:59:59.9000000Z",
//             "close": 12.8440770481941
//         },
//         {
//             "date": "2024-07-23T23:59:00.0000000Z",
//             "close": 12.2031662301885
//         },
//         {
//             "date": "2024-07-24T23:59:59.9000000Z",
//             "close": 11.9080439152752
//         },
//         {
//             "date": "2024-07-25T23:59:00.0000000Z",
//             "close": 11.8564523438619
//         },
//         {
//             "date": "2024-07-26T23:59:00.0000000Z",
//             "close": 12.4911917389626
//         },
//         {
//             "date": "2024-07-27T23:59:59.9000000Z",
//             "close": 12.283617465002
//         },
//         {
//             "date": "2024-07-28T23:59:00.0000000Z",
//             "close": 12.679564347749
//         },
//         {
//             "date": "2024-07-29T23:59:00.0000000Z",
//             "close": 12.2782029016063
//         },
//         {
//             "date": "2024-07-30T23:59:00.0000000Z",
//             "close": 12.8267125886512
//         },
//         {
//             "date": "2024-07-31T23:59:00.0000000Z",
//             "close": 12.6256868071164
//         },
//         {
//             "date": "2024-08-01T23:59:59.9000000Z",
//             "close": 12.2889731488299
//         },
//         {
//             "date": "2024-08-02T23:59:59.9000000Z",
//             "close": 11.5448026758591
//         },
//         {
//             "date": "2024-08-03T23:59:59.9000000Z",
//             "close": 11.2698416175158
//         },
//         {
//             "date": "2024-08-04T23:59:00.0000000Z",
//             "close": 10.8080045998975
//         },
//         {
//             "date": "2024-08-05T23:59:49.1000000Z",
//             "close": 9.74383794928627
//         },
//         {
//             "date": "2024-08-06T23:59:59.8000000Z",
//             "close": 10.1731058292979
//         },
//         {
//             "date": "2024-08-07T23:59:59.9000000Z",
//             "close": 9.92024558453302
//         },
//         {
//             "date": "2024-08-08T23:59:59.9000000Z",
//             "close": 10.3624482651043
//         },
//         {
//             "date": "2024-08-09T23:59:57.5000000Z",
//             "close": 10.154120091318
//         },
//         {
//             "date": "2024-08-10T23:59:59.9000000Z",
//             "close": 10.2119702356312
//         },
//         {
//             "date": "2024-08-11T23:59:59.9000000Z",
//             "close": 9.52327622746466
//         },
//         {
//             "date": "2024-08-12T23:59:59.9000000Z",
//             "close": 9.99138068527888
//         },
//         {
//             "date": "2024-08-13T23:59:59.9000000Z",
//             "close": 9.94261786410131
//         },
//         {
//             "date": "2024-08-14T23:59:59.9000000Z",
//             "close": 9.83133649549416
//         },
//         {
//             "date": "2024-08-15T23:59:59.9000000Z",
//             "close": 9.71193626475225
//         },
//         {
//             "date": "2024-08-16T23:59:59.8000000Z",
//             "close": 9.79252186487214
//         },
//         {
//             "date": "2024-08-17T23:59:46.4000000Z",
//             "close": 9.94073993693255
//         },
//         {
//             "date": "2024-08-18T23:59:59.9000000Z",
//             "close": 10.0820978788736
//         },
//         {
//             "date": "2024-08-19T23:59:59.8000000Z",
//             "close": 10.1831212725726
//         },
//         {
//             "date": "2024-08-20T23:59:59.8000000Z",
//             "close": 10.5589344953403
//         },
//         {
//             "date": "2024-08-21T23:59:59.8000000Z",
//             "close": 11.2718905962389
//         },
//         {
//             "date": "2024-08-22T23:59:52.4000000Z",
//             "close": 11.490869071533
//         },
//         {
//             "date": "2024-08-23T23:59:59.8000000Z",
//             "close": 12.1085764306401
//         },
//         {
//             "date": "2024-08-24T23:59:59.8000000Z",
//             "close": 11.6144604076903
//         },
//         {
//             "date": "2024-08-25T23:59:59.8000000Z",
//             "close": 11.613600646593
//         },
//         {
//             "date": "2024-08-26T23:59:47.8000000Z",
//             "close": 12.003061784762
//         },

//         {
//             "date": "2024-08-26T23:59:47.8000000Z",
//             "close": 12.003061784762
//         },
//         {
//             "date": "2024-08-26T23:59:47.8000000Z",
//             "close": 12.003061784762
//         }
//     ]

// }]

// var dateList = []
function parseData(data) {
    var dateList = []
    var valueList = []
    var symbolList = []
    data.forEach(asset => {
        const { symbol, data } = asset;
        symbolList.push(symbol);
        dateList = data.map((item) => {
            return item.date.slice(0, 10);
        });
        valueList.push(
            data.map(function (item) {
                return Math.round(item.close * 100) / 100;
            })
        );
    })
    // console.log(dateList)
    console.log(valueList)
    return [dateList, valueList, symbolList]
}

// Prepare data for ECharts
function prepareForEcharts(valueList, symbolList){
    // console.log('get series')
    const series = valueList.map((data, index) => ({
        name: `${symbolList[index]}`,
        type: 'line',
        data: data
    }));
    console.log(series)
    return series
}

// function drawLinechart(id, series, date){
function drawLinechart(id, histData){
    
    const [dateList, valueList, symbolList] = parseData(histData)
    const series = prepareForEcharts(valueList, symbolList)
    var linechart = echarts.init(document.getElementById(id));
    var option = {
        // Make gradient line here
        title: [
            {
                left: 'center',
                text: 'Gradient along the y axis'
            },
        ],
        legend: {
            // data: series.map(s => s.name)
        },
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            splitline: { show: false },
            data: dateList
        },
        yAxis: {
            type: 'value',
            splitLine: {
                show: false
            }
        },
        grid: [
            {
                bottom: '10%',
                top: '10%'
            },
        ],
        series: series
        // [
        //   {type: 'line',showSymbol: false,data: valueList}
        // ]
    };

    linechart.setOption(option)
    // linechart2.setOption(option)
}

// drawLinechart('linechart1', allStock)
drawLinechart('linechart2', allCrypto)